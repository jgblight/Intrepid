<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/cupertino/jquery-ui.css" />
  <link href='//fonts.googleapis.com/css?family=Josefin+Slab:400,600|Raleway' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/static/css/jquery.drag-n-crop.css">
	<link rel="stylesheet" href="/static/css/intrepid.css">

  <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
  <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.0.4/jquery.imagesloaded.min.js"></script>
  <script src="/static/js/scale.fix.js"></script>
  <script src='/static/js/jquery.drag-n-crop.js'></script> 
	<script type="text/javascript"
	      src="//maps.googleapis.com/maps/api/js?key=AIzaSyDml8K6lGP_FoE7gH8ffhCAdN8Dkltf1as&libraries=places&sensor=false">
  </script>
  {% block dependencies %}{% endblock %}
  <script type="text/javascript">
  	var map;
    var markerArray = [];

    function clearMap() {
      for (var i = 0; i < markerArray.length; i++ ) {
        markerArray[i].setMap(null);
      }
      markerArray.length = [];
    };

    {% block script_functions %}{% endblock %}      

  	function initialize() {
      {% block initialize_map %}
  		var mapOptions = {
  		      center: new google.maps.LatLng(0,0),
            zoom: 2,
            mapTypeId: google.maps.MapTypeId.TERRAIN,
            mapTypeControl: false,
            panControl: true,
            zoomControl: true,
            streetViewControl: false
          };
      map = new google.maps.Map($("#map-canvas")[0], mapOptions);
      {% endblock %}

      $(".link-item").click(function(){
       window.location=$(this).attr("href"); 
       return false;
      });

      $(".dropdown-toggle").dropdown();
      
      {% block initialize_script %}{% endblock %}

      };

  	$( window ).load(initialize);
  </script>

</head>
<body>

<div class="container fill width-fill">
<div class="row header">
  <div class="col-xs-3 col-sm-3">
    <h2 class="logo link-item" href="/"> Intrepid</h2>
  </div>

  <div class="col-xs-9 col-sm-9  header-right">
  {% if user.is_authenticated %}
    <img class="header-icon link-item" href="/profile/{{user.username}}" src="{{user.profile.get_image_url}}"/>
    <div class="dropdown header-button-wrapper">
      <span class="btn btn-primary dropdown-toggle" id="dLabel" data-toggle="dropdown" > 
       <span class="glyphicon glyphicon-pencil"></span> New Pin</span>
    <ul class="dropdown-menu right-menu" role="menu" aria-labelledby="dLabel">
      {% for trip in user.profile.get_active_trips %}
      <li class="drop-link"> <a href="/trip/{{trip.id}}/post"> {{trip.name}} </a> </li>
      {% endfor %}
      <li class="drop-link"> <a href="/trip/new"> New Trip </a> </li>
    </ul>
    </div>
    <div class="header-button-wrapper">
      <a href="/logout" class="btn btn-info" > Log Out</a>
    </div>
  {% else %}
    <div class="header-button-wrapper">
      <a href="/login" class="btn btn-info" > Log In</a>
    </div>
  {% endif %}
  </div>
</div>
<div class="row width-fill main">
  <div class="col-xs-6 col-sm-8 fill">
	<div id="map-canvas"></div>
  </div>
  <div class="col-xs-6 col-sm-4 fill info-div">
    {% block content %}{% endblock %}
  </div>
</div>
</div>

</body>
</html>